# Документация API

## Общая информация

Данный проект использует OpenAPI (Swagger) для автоматической генерации документации API. Вы можете просмотреть интерфейс Swagger UI по адресу:

[Swagger UI](http://localhost:8080/swagger-ui.html)

Этот документ описывает основные эндпоинты, доступные в API.

---

## 1. Авторизация (`/api/auth`)

### Регистрация нового пользователя

- **Метод:** `POST`
- **Путь:** `/api/auth/registration`
- **Описание:** Создает новую учетную запись пользователя.
- **Тело запроса (JSON):**
  ```json
  {
    "username": "string",
    "password": "string"
  }
- **Ответы:**
1. 200 OK: Успешная регистрация ("Success registration").
2. 400 Bad Request: Ошибки валидации или имя пользователя уже занято.
3. 500 Internal Server Error: Ошибка сервера.
### Аутентификация пользователя
- **Метод:** `POST`
- **Путь:** `/api/auth/login`
- **Описание:** Аутентифицирует пользователя и возвращает JWT-токен.
Тело запроса (JSON):
- **Тело запроса (JSON):**
  ```json
  {
    "username": "string",
    "password": "string"
  }
- **Ответы:**
1. 200 OK: Успешная аутентификация (в теле возвращается JWT-токен).
2. 401 Unauthorized: Неверные учетные данные.
3. 500 Internal Server Error: Ошибка сервера.
## 2. Операции пользователя (/api/users)
   Все эндпоинты этого контроллера требуют JWT-токен в заголовке Authorization: Bearer <token>.

### Получение всех карт пользователя
- **Метод:** `GET`
- **Путь:** `/api/users/cards`
- **Описание:** Возвращает список всех банковских карт, принадлежащих аутентифицированному пользователю.
  ###Получение карт пользователя с пагинацией


- **Метод:** `GET`
- **Путь:** `/api/users/cards/paginated`
- **Описание:** Возвращает список карт пользователя с поддержкой пагинации.
- **Параметры запроса:**
- **page (integer, optional, default: 0):** Номер страницы.
- **size (integer, optional, default: 10):** Размер страницы.
### Получение активных карт пользователя
- **Метод:** `GET`
- **Путь:** `/api/users/cards/active`
- **Описание:** Возвращает список только активных карт пользователя.
### Блокировка своей карты
- **Метод:** `PUT`
- **Путь:** `/api/users/cards/{cardId}/block`
- **Описание:** Блокирует конкретную карту, принадлежащую пользователю.
- **Параметры пути:**
- **cardId (integer):** ID карты для блокировки.
### Перевод средств между своими картами
- **Метод:** `POST`
- **Путь:** `/api/users/transfer`
- **Описание:** Переводит средства с одной карты пользователя на другую его же карту.
- **Тело запроса (JSON):**
```json
  {
  "sourceCardId": 0, 
  "targetCardId": 0, 
  "amount": 0        
}
```
### Получение баланса конкретной карты
- **Метод:** `GET`
- **Путь:** `/api/users/cards/{cardId}/balance`
- **Описание:** Возвращает баланс конкретной карты пользователя.
- **Параметры пути:**
- **cardId (integer):** ID карты.
### Получение общего баланса по всем картам
- **Метод:** `GET`
- **Путь:** `/api/users/cards/total-balance`
- **Описание:** Возвращает сумму балансов по всем картам пользователя.
  ###Получение информации о пользователе
- **Метод:** `GET`
- **Путь:** `/api/users/info`
- **Описание:** Возвращает информацию об аутентифицированном пользователе (ID, имя пользователя).
## 3. Операции администратора (/api/admin)
   Все эндпоинты этого контроллера требуют JWT-токен с ролью ADMIN в заголовке Authorization: Bearer <token>.

### Управление картами
### Создание новой карты
- **Метод:** `POST`
- **Путь:** `/api/admin/cards/create`
- **Описание:** Создает новую банковскую карту для указанного пользователя.
- **Тело запроса (JSON):**
```json
  {
  "cardNumber": "string",  
  "expiryDate": "string",  
  "userId": 0              
  }
```
### Блокировка карты
- **Метод:** `PUT`
- **Путь:** `/api/admin/cards/{cardId}/block`
- **Описание:** Блокирует карту по её ID.
- **Параметры пути:**
- **cardId (integer):** ID карты для блокировки.
### Активация карты
- **Метод:** `PUT`
- **Путь:** `/api/admin/cards/{cardId}/activate`
- **Описание:** Активирует (разблокирует) карту по её ID.
- **Параметры пути:**
- **cardId (integer):** ID карты для активации.
### Удаление карты
- **Метод:** `DELETE`
- **Путь:** `/api/admin/cards/{cardId}/delete`
- **Описание:** Удаляет карту по её ID.
- **Параметры пути:**
- **cardId (integer):** ID карты для удаления.
### Получение всех карт
- **Метод:** `GET`
- **Путь:** `/api/admin/cards`
- **Описание:** Возвращает список всех карт в системе.
### Получение карты по ID
- **Метод:** `GET`
- **Путь:** `/api/admin/cards/{cardId}`
- **Описание:** Возвращает информацию о конкретной карте по её ID.
- **Параметры пути:**
- **cardId (integer):** ID карты.
### Установка баланса карты по ID карты
- **Метод:** `PUT`
- **Путь:** `/api/admin/cards/{cardId}/setBalanceByCardId`
- **Описание:** Устанавливает новый баланс для карты, используя её ID.
- **Параметры пути:**
- **cardId (integer):** ID карты.
- **Тело запроса (JSON):**
```json
  {
  "balance": 0
  }
```
### Установка баланса карты по номеру карты
- **Метод:** `PUT`
- **Путь:** `/api/admin/cards/setBalanceByCardNumber`
- **Описание:** Устанавливает новый баланс для карты, используя её номер.
- **Тело запроса (JSON):**
```json
  {
  "cardNumber": "string", 
  "balance": 0            
  }
```
- ### Управление пользователями
### Создание нового пользователя
- **Метод:** `POST`
- **Путь:** `/api/admin/users/create`
- **Описание:** Создает новую учетную запись пользователя (администратором).
- **Тело запроса (JSON):**
```json
  {
  "username": "string", 
  "password": "string", 
  "role": "string" // "ADMIN" или "USER"
  }
```
### Получение всех пользователей
- **Метод:** `GET`
- **Путь:** `/api/admin/users`
- **Описание:** Возвращает список всех пользователей в системе.
### Получение пользователя по ID
- **Метод:** `GET`
- **Путь:** `/api/admin/users/{userId}`
- **Описание:** Возвращает информацию о конкретном пользователе по его ID.
- **Параметры пути:**
- **userId (integer):** ID пользователя.
### Обновление пользователя
- **Метод:** `PUT`
- **Путь:** `/api/admin/users/{userId}/update`
- **Описание:** Обновляет информацию о пользователе (имя, роль).
- **Параметры пути:**
- **userId (integer):** ID пользователя.
- **Тело запроса (JSON):**
```json
  {
  "username": "string",
  "password": "string", 
  "role": "string"      
   }
```
### Удаление пользователя
- **Метод:** `DELETE`
- **Путь:** `/api/admin/users/{userId}/delete`
- **Описание:** Удаляет пользователя по его ID.
- **Параметры пути:**
- **userId (integer):** ID пользователя для удаления. 
### Безопасность
- Шифрование данных: Пароли хэшируются с помощью BCrypt.
- Привязка ролей: Используются роли ADMIN и USER.
- Защита от CSRF: Отключена для RESTful API.
- Авторизация через JWT: Все защищенные эндпоинты требуют JWT-токена.